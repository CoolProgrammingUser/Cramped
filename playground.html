<!doctype html>
<html>
	<head>
		<title>
			Cramped
		</title>
		<base target="_blank">
		<link rel="icon" href="images/favicon.ico">
		<script src="https://epicenterprograms.github.io/standards/behavior/general.js"></script>
		<!--
		<script src="file:///C:/Users/Robert/Documents/GitHub/standards/behavior/general.js"></script>
		-->
		<script src="behavior.js"></script>
		<script>
			var randomNoises;
			var blabbermouth = new S.Speaker();

			S.listen("playRandomNoises", "click", function () {
				if (this.textContent.trim() == "Play random noises") {
					let noisemaker = new S.Sound();
					let playString;
					function addNote() {
						playString += ["a", "b", "c", "d", "e", "f", "g"][Math.floor(Math.random() * 7)] + (Math.floor(Math.random() * 2) + 4);
					}
					function maybeAddSlur() {
						if (Math.round(Math.random())) {
							playString += "s";
						} else {
							addNote();
						}
					}
					randomNoises = setInterval(function () {
						if (Math.round(Math.random())) {
							noisemaker.change("waveform", "sawtooth");
						} else {
							noisemaker.change("waveform", "square");
						}
						playString = "";
						addNote();
						maybeAddSlur();
						maybeAddSlur();
						addNote();
						noisemaker.play(playString, { noteLength: 150, attack: 1, decay: 1 });
					}, 610);
					this.textContent = "Stop random noises";
				} else {
					clearInterval(randomNoises);
					this.textContent = "Play random noises";
				}
			});

			S.listen("script", "dblclick", function () {
				this.value = "";
			});
			S.listen("speak", "click", function () {
				if (!blabbermouth.speaking) {
					blabbermouth.speak(S.getId("script").value);
				}
			});
			S.listen(["Enter"], "keydown", function () {
				if (S.getId("script") === document.activeElement) {
					S.getId("speak").click();
				}
			});
			S.listen("vodka", "click", function () {
				if (this.checked) {
					blabbermouth.rate = .3;
					blabbermouth.pitch = 2;
				} else {
					blabbermouth.rate = 1;
					blabbermouth.pitch = 1;
				}
			});

			S.onLoad(function () {
				S.makeToneGenerator(true);
			});
		</script>
		<link rel="stylesheet" href="https://epicenterprograms.github.io/standards/formatting/foundation.css">
		<link rel="stylesheet" href="formatting.css">
		<style>

		</style>
	</head>
	<body class="left-nav">
		<iframe class="left-nav" src="navigation.html"></iframe>
		<h1 class="main-title">
			Playground
		</h1>
		<main>
			<button id="playRandomNoises">
				Play random noises
			</button>
			<br>
			<br>
			<input type="text" id="script">
			<button id="speak">
				Speak
			</button>
			<input type="checkbox" id="vodka">
			<label for="vodka">
				Drunken puberty voice
			</label>
		</main>
	</body>
</html>
